<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Local Shazam ‚Äì Pure JS (FFT + Spectrogram, No APIs)</title>
    <link rel="stylesheet" href="index.css">
    <script src="index.js" defer></script>
</head>
<body>
<div class="wrap">
    <h1>Local Shazam <span class="pill">Pure JavaScript</span></h1>
    <p class="muted">All recognition happens locally in your browser. No API key, no third‚Äëparty calls. Uses FFT + spectrogram + peak hashing.</p>

    <div class="row">
        <div class="glass card" style="flex: 1; min-width: 300px">
            <h3>1) Build a local reference library</h3>
            <input id="refFiles" type="file" accept="audio/*" multiple />
            <p class="muted" style="margin: 8px 0 0">Tip: add short clips (~30‚Äì60s). The app fingerprints them locally.</p>
            <div id="refList" class="list" style="margin-top: 10px"></div>
        </div>

        <div class="glass card" style="flex:1;min-width:300px">
            <h3>2) Identify a recording</h3>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap">
                <button id="recordBtn">üéôÔ∏è Listen (6s)</button>
                <span id="status" class="muted">Idle</span>
            </div>
            <div style="margin-top: 10px">
                <canvas id="spec" width="800" height="260"></canvas>
            </div>
            <div id="result" style="margin-top: 10px"></div>
        </div>
    </div>

    <div class="glass card" style="margin-top: 16px">
        <h3>How it works</h3>
        <ol>
            <li>Decode audio to PCM ‚Üí downsample to 11025 Hz.</li>
            <li>Frame into windows (N=2048, hop=512), apply Hann window.</li>
            <li>FFT ‚Üí magnitude ‚Üí log scale ‚Üí spectrogram.</li>
            <li>Peak picking (top local maxima per frame). Pair peaks within a time window to form hashes: <code>(f1,f2,Œît)</code>.</li>
            <li>Store a hash table: <code>hash ‚Üí [{trackId, tRef}]</code>.</li>
            <li>For a query clip, compute hashes and tally <code>offset = tRef - tQuery</code> votes per track. Best (track,offset) wins.</li>
        </ol>
    </div>
</div>

<script>
</script>
</body>
</html>
